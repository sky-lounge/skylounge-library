---
uri: sky-lounge/skylounge-library/blueprints/cloudfoundry/cloud-gov/blueprint.yml
params:
  main_branch: main
workflows:
  pull-request:
    jobs:
      unit-test:
        - steps:
            unit-test:
              - label: go
                uri: sky-lounge/skylounge-library/steps/unit-test/go/unit-test.yml
                params:
                  go_version: stable
                  check_latest: true
              - label: gradlew
                uri: sky-lounge/skylounge-library/steps/unit-test/gradlew/unit-test.yml
                params:
                  distribution: liberica
                  jvm_version: "17"
              - label: maven
                uri: sky-lounge/skylounge-library/steps/unit-test/maven/unit-test.yml
                params:
                  distribution: liberica
                  jvm_version: "17"
              - label: nginx
                uri: sky-lounge/skylounge-library/steps/unit-test/nginx/unit-test.yml
              - label: python
                uri: sky-lounge/skylounge-library/steps/unit-test/python/unit-test.yml
                params:
                  package_manager: pip
                  python_version: "3.11"
              - label: ruby
                uri: sky-lounge/skylounge-library/steps/unit-test/ruby/unit-test.yml
                params:
                  ruby_version: "3.2.2"
      dependency-review:
        - params:
            config_file: "sky-lounge/skylounge-library/jobs/github/security/dependency-review/config/cloud-gov.yml@main"
      codeql:
        - label: go
          params:
            language_array: ["Go"]
          steps:
            build:
              - uri: sky-lounge/skylounge-library/steps/github/security/codeql/auto-build/step.yml
        - label: java
          params:
            language_array: ["Java"]
          steps:
            build:
              - uri: sky-lounge/skylounge-library/steps/github/security/codeql/auto-build/step.yml
        - label: nginx
          params:
            language_array: ["JavaScript"]
          steps:
            build:
              - uri: sky-lounge/skylounge-library/steps/github/security/codeql/script-build/step.yml
        - label: python
          params:
            language_array: ["Python"]
          steps:
            build:
              - uri: sky-lounge/skylounge-library/steps/github/security/codeql/script-build/step.yml
        - label: ruby
          params:
            language_array: ["Ruby"]
          steps:
            build:
              - uri: sky-lounge/skylounge-library/steps/github/security/codeql/script-build/step.yml
  development:
    jobs:
      deploy:
        - steps:
            deploy:
              - uri: sky-lounge/skylounge-library/steps/cloudfoundry/deploy/deploy.yml
                params:
                  cf_api: "https://api.de.a9s.eu"
                  cf_username: "${{ secrets.CF_DEV_USERNAME }}"
                  cf_password: "${{ secrets.CF_DEV_PASSWORD }}"
                  cf_manifest: "cf/dev-manifest.yml"
  production:
    jobs:
      deploy:
        - steps:
            deploy:
              - uri: sky-lounge/skylounge-library/steps/cloudfoundry/deploy/deploy.yml
                params:
                  cf_api: "https://api.de.a9s.eu"
                  cf_username: "${{ secrets.CF_PROD_USERNAME }}"
                  cf_password: "${{ secrets.CF_PROD_PASSWORD }}"
                  cf_manifest: "cf/prod-manifest.yml"
  scans:
    jobs:
      dependency-review:
        - params:
            config_file: "sky-lounge/skylounge-library/jobs/github/security/dependency-review/config/cloud-gov.yml@main"
