---
uri: sky-lounge/skylounge-library/blueprints/trunk/webapp/blueprint.yml
workflows:
  development:
    jobs:
      unit-test:
        - steps:
            unit-test:
              - label: go
                uri: sky-lounge/skylounge-library/steps/unit-test/go/step.yml
                params:
                  go_version: stable
                  check_latest: true
              - label: gradlew
                uri: sky-lounge/skylounge-library/steps/unit-test/gradlew/step.yml
                params:
                  distribution: liberica
                  jvm_version: "17"
              - label: maven
                uri: sky-lounge/skylounge-library/steps/unit-test/maven/step.yml
                params:
                  distribution: liberica
                  jvm_version: "17"
              - label: nginx
                uri: sky-lounge/skylounge-library/steps/unit-test/nginx/step.yml
              - label: python
                uri: sky-lounge/skylounge-library/steps/unit-test/python/step.yml
                params:
                  package_manager: pip
                  python_version: "3.11"
              - label: ruby
                uri: sky-lounge/skylounge-library/steps/unit-test/ruby/step.yml
                params:
                  ruby_version: "3.2.2"
      build:
        - steps:
            authenticate-to-image-repository:
              - label: gcp
                uri: sky-lounge/skylounge-library/steps/gcp/cloud-auth/auth.yml
                params:
                  credentials_json_secret_string: "${{ secrets.GOOGLE_CREDENTIALS_DEV }}"
            build-container-image:
              - label: gradlew
                uri: sky-lounge/skylounge-library/steps/pack/gradlew/build.yml
                params:
                  jvm_version: 17
                  distribution: liberica
              - label: nginx
                uri: sky-lounge/skylounge-library/steps/pack/nginx/build.yml
            push-container-image:
              - label: gcp
                uri: sky-lounge/skylounge-library/steps/gcp/artifact-registry/push.yml
      deploy:
        - label: cloud-run
          uri: sky-lounge/skylounge-library/jobs/gcp/cloud-run/deploy/deploy.yml
          params:
            credentials_json_secret_string: "${{ secrets.GOOGLE_CREDENTIALS_DEV }}"
