---
blueprint-uri: sky-lounge/skylounge-library/blueprints/app/web/blueprint.yml
workflows:
  - workflow: development
    jobs:
      - job: unit-test
        steps:
          - step: unit-test
            uri: # Enter the URI to the step definition used to run unit tests for your application. Example: sky-lounge/skylounge-library/steps/unit-test/gradlew/unit-test.yml
      - job: build
        steps:
          - step: cloud-auth
            uri: # Enter the URI to the step definition used to build the authenticate to the cloud provider. Example: sky-lounge/skylounge-library/steps/gcp/cloud-auth/auth.yml
          - step: build-container-image
            uri: # Enter the URI to the step definition used to build the container image for your application. Example: sky-lounge/skylounge-library/steps/pack/nginx/build.yml
          - step: push-container-image
            uri: # Enter the URI to the step definition used to push the container image to a registry. Example: sky-lounge/skylounge-library/steps/gcp/artifact-registry/push/push.yml
          - step: upload-sboms
            uri: # Enter the URI to the step definition used to upload the SBOMs to storage. Example: sky-lounge/skylounge-library/steps/gcp/cloud-storage/sbom/push/push.yml
      - job: deploy
        uri: # The URI to the job definition for deployment. Example: sky-lounge/skylounge-library/jobs/gcp/cloud-run/deploy/deploy.yml
    params:
      build_paths: # An array of paths which trigger the build job on change. Example: ["src/**", "build.gradle", "service.yaml"]
#       - job: deploy
#       - job: integration-test
#         uri: # The URI to your integration tests. Example: sky-lounge/hello-app/skylounge/integration-test.yml
#     params:
#       gcp_project: # The Google Cloud project name where the application is deployed. Example: skylounge-dev
#       cloud_run_domain: # The domain to configure for your application. Example: dashboard.skylounge.dev
#   - workflow: production
#     jobs:
#       - job: deploy
#     params:
#       gcp_project: # The Google Cloud project name where the application is deployed. Example: skylounge-prod
#   - workflow: scans
#     jobs:
#       - job: owasp-zap-full-scan
#         params:
#           endpoint_to_scan: # The production endpoint to scan. Example: https://dashboard.skylounge.io
#     params:
#       cron_schedule: # Schedule a workflow to run at specific UTC times using POSIX cron syntax: https://pubs.opengroup.org/onlinepubs/9699919799/utilities/crontab.html#tag_20_25_07. Example: "0 2 * * *" to run everyday at 2AM
# params:
#   registry_url: # The artifact registry url where container images are stored. Example: us-central1-docker.pkg.dev/skylounge-common/skylounge-registry
